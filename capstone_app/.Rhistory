library(rsconnect)
setwd('/Users/manuelrueda/Dropbox/Documents/python/f16-GS/capstone_app')
deployApp()
deployApp()
shiny::runApp()
runApp()
companies <- read.csv('cik_sample.csv', stringsAsFactors = FALSE)
colnames(companies) <- c('Company.Name', 'CIK')
companies$CIK <- sprintf('%010d', companies$CIK)
companies <- companies[!duplicated(companies[,'CIK']),]
risk_data <- read.csv("risk_data.csv")
business_data <- read.csv("business_data.csv")
risk_data <- unique(risk_data)
colnames(risk_data) <- c('CIK', 'Jaccard', 'TF-IDF', 'Word2Vec', 'Common Words', 'Deleted Words','New Words', 'Total Words', 'Top Words', 'Year')
risk_data[,c(2:7)] = round(risk_data[,c(2:7)],2)
risk_data$CIK <- sprintf('%010d', risk_data$CIK)
risk_data <- merge(x = risk_data, y = companies[,c('CIK', 'Company.Name')], by = "CIK", all.x = TRUE)
business_data <- unique(business_data)
colnames(business_data) <- c('CIK', 'Jaccard', 'TF-IDF', 'Word2Vec', 'Common Words', 'Deleted Words','New Words', 'Total Words', 'Top Words', 'Year')
business_data[,c(2:7)] = round(business_data[,c(2:7)],2)
business_data$CIK <- sprintf('%010d', business_data$CIK)
business_data <- merge(x = business_data, y = companies[,c('CIK', 'Company.Name')], by = "CIK", all.x = TRUE)
risk_data <- risk_data[risk_data$Year != 2007,]
business_data <- business_data[business_data$Year != 2007,]
risk_data$Word2Vec <- round(risk_data$Word2Vec / max(risk_data$Word2Vec),2)
business_data$Word2Vec <- round(business_data$Word2Vec / max(business_data$Word2Vec),2)
means <- round(colMeans(risk_data[,c('Jaccard','TF-IDF','Word2Vec')]),2)
means <- round(colMeans(business_data[,c('Jaccard','TF-IDF','Word2Vec')]),2)
all_years = c(2008,2009,2010,2011,2012,2013,2014,2015)
all_companies <- unique(risk_data$CIK)
filled_risk <- risk_data[, c('Year', 'CIK', 'Company.Name', 'Jaccard', 'TF-IDF', 'Word2Vec')]
filled_business <- business_data[, c('Year', 'CIK', 'Company.Name', 'Jaccard', 'TF-IDF', 'Word2Vec')]
for(company in all_companies) {
tmp_data <- risk_data[risk_data$CIK == company, c('Year', 'CIK', 'Company.Name', 'Jaccard', 'TF-IDF', 'Word2Vec')]
missing_years = setdiff(all_years, unique(tmp_data$Year))
name <- unique(tmp_data$Company.Name)
cik <- unique(tmp_data$CIK)
for(year in missing_years) {
new_row = c(year, cik, name, means[1], means[2], means[3])
filled_risk = rbind(filled_risk, new_row)
}
}
filled_risk <- arrange(filled_risk, CIK, Year)
update.cols <- c('Year','Jaccard', 'TF-IDF', 'Word2Vec')
filled_risk[update.cols] <- sapply(filled_risk[update.cols],as.numeric)
for(company in all_companies) {
tmp_data <- business_data[business_data$CIK == company, c('Year', 'CIK', 'Company.Name', 'Jaccard', 'TF-IDF', 'Word2Vec')]
missing_years = setdiff(all_years, unique(tmp_data$Year))
name <- unique(tmp_data$Company.Name)
cik <- unique(tmp_data$CIK)
for(year in missing_years) {
new_row = c(year, cik, name, means[1], means[2], means[3])
filled_business = rbind(filled_business, new_row)
}
}
filled_business <- arrange(filled_business, CIK, Year)
update.cols <- c('Year','Jaccard', 'TF-IDF', 'Word2Vec')
filled_business[update.cols] <- sapply(filled_business[update.cols],as.numeric)
mapping_risk <- seq(length(unique(filled_risk$Company.Name)))
names(mapping_risk) <- unique(filled_risk$Company.Name)
filled_risk$Id <- mapping_risk[filled_risk$Company.Name]
risk_data$Id <- mapping_risk[risk_data$Company.Name]
mapping_business <- seq(length(unique(filled_business$Company.Name)))
names(mapping_business) <- unique(filled_business$Company.Name)
filled_business$Id <- mapping_business[filled_business$Company.Name]
business_data$Id <- mapping_business[business_data$Company.Name]
cik_map <- unique(risk_data[c('CIK','Company.Name')])
runApp()
heatmap <- highchart() %>%
hc_chart(type = "heatmap")
heatmap <- heatmap %>%
hc_add_series(name = "Jaccard", data = list_parse2(filled_business[,c('Year','Id','Jaccard')]))
heatmap <- heatmap %>%
hc_yAxis(categories = c('', names(mapping_business))) %>%
hc_colorAxis(minColor = "#ffd3b6", maxColor = "#ff8b94")
heatmap
filled_business
head(filled_business)
names(mapping_business))
names(mapping_business)
heatmap <- highchart() %>%
hc_chart(type = "heatmap")
heatmap <- heatmap %>%
hc_add_series(name = "Jaccard", data = list_parse2(filled_business[,c('Year','Id','Jaccard')]))
heatmap <- heatmap %>%
#hc_yAxis(categories = c('', names(mapping_business))) %>%
hc_colorAxis(minColor = "#ffd3b6", maxColor = "#ff8b94")
heatmap
list_parse2(filled_business[,c('Year','Id','Jaccard')])
runApp()
mapping_business
mapping_risk
names(mapping_risk)
names(mapping_risk) %in% names(mapping_business)
names(mapping_business) %in% names(mapping_risk)
mapping_business[!names(mapping_business) %in% names(mapping_risk)]
mapping_business
setwd('/Users/manuelrueda/Dropbox/Documents/python/f16-GS/capstone_app')
companies <- read.csv('cik_sample.csv', stringsAsFactors = FALSE)
colnames(companies) <- c('Company.Name', 'CIK')
companies <- companies[!duplicated(companies[,'CIK']),]
risk_data <- read.csv("risk_data.csv")
business_data <- read.csv("business_data.csv")
risk_data <- unique(risk_data)
colnames(risk_data) <- c('CIK', 'Jaccard', 'TF-IDF', 'Word2Vec', 'Common Words', 'Deleted Words','New Words', 'Total Words', 'Top Words', 'Year')
risk_data[,c(2:7)] = round(risk_data[,c(2:7)],2)
risk_data$CIK <- sprintf('%010d', risk_data$CIK)
risk_data <- merge(x = risk_data, y = companies[,c('CIK', 'Company.Name')], by = "CIK", all.x = TRUE)
business_data <- unique(business_data)
colnames(business_data) <- c('CIK', 'Jaccard', 'TF-IDF', 'Word2Vec', 'Common Words', 'Deleted Words','New Words', 'Total Words', 'Top Words', 'Year')
business_data[,c(2:7)] = round(business_data[,c(2:7)],2)
business_data$CIK <- sprintf('%010d', business_data$CIK)
business_data <- merge(x = business_data, y = companies[,c('CIK', 'Company.Name')], by = "CIK", all.x = TRUE)
risk_data <- risk_data[risk_data$Year != 2007,]
business_data <- business_data[business_data$Year != 2007,]
risk_data$Word2Vec <- round(risk_data$Word2Vec / max(risk_data$Word2Vec),2)
business_data$Word2Vec <- round(business_data$Word2Vec / max(business_data$Word2Vec),2)
means <- round(colMeans(risk_data[,c('Jaccard','TF-IDF','Word2Vec')]),2)
means <- round(colMeans(business_data[,c('Jaccard','TF-IDF','Word2Vec')]),2)
all_years = c(2008,2009,2010,2011,2012,2013,2014,2015)
all_companies <- unique(risk_data$CIK)
filled_risk <- risk_data[, c('Year', 'CIK', 'Company.Name', 'Jaccard', 'TF-IDF', 'Word2Vec')]
filled_business <- business_data[, c('Year', 'CIK', 'Company.Name', 'Jaccard', 'TF-IDF', 'Word2Vec')]
for(company in all_companies) {
tmp_data <- risk_data[risk_data$CIK == company, c('Year', 'CIK', 'Company.Name', 'Jaccard', 'TF-IDF', 'Word2Vec')]
missing_years = setdiff(all_years, unique(tmp_data$Year))
name <- unique(tmp_data$Company.Name)
cik <- unique(tmp_data$CIK)
for(year in missing_years) {
new_row = c(year, cik, name, means[1], means[2], means[3])
filled_risk = rbind(filled_risk, new_row)
}
}
filled_risk <- arrange(filled_risk, CIK, Year)
update.cols <- c('Year','Jaccard', 'TF-IDF', 'Word2Vec')
filled_risk[update.cols] <- sapply(filled_risk[update.cols],as.numeric)
for(company in all_companies) {
tmp_data <- business_data[business_data$CIK == company, c('Year', 'CIK', 'Company.Name', 'Jaccard', 'TF-IDF', 'Word2Vec')]
missing_years = setdiff(all_years, unique(tmp_data$Year))
name <- unique(tmp_data$Company.Name)
cik <- unique(tmp_data$CIK)
for(year in missing_years) {
new_row = c(year, cik, name, means[1], means[2], means[3])
filled_business = rbind(filled_business, new_row)
}
}
filled_business <- arrange(filled_business, CIK, Year)
update.cols <- c('Year','Jaccard', 'TF-IDF', 'Word2Vec')
filled_business[update.cols] <- sapply(filled_business[update.cols],as.numeric)
mapping_risk <- seq(length(unique(filled_risk$Company.Name)))
names(mapping_risk) <- unique(filled_risk$Company.Name)
seq(length(unique(filled_business$Company.Name)))
unique(filled_business$Company.Name)
setwd('/Users/manuelrueda/Dropbox/Documents/python/f16-GS/capstone_app')
## Read data.
#companies <- read.csv('cik_new.csv', header=FALSE, sep='|', stringsAsFactors = FALSE)
companies <- read.csv('cik_sample.csv', stringsAsFactors = FALSE)
colnames(companies) <- c('Company.Name', 'CIK')
#companies$CIK <- sprintf('%010d', companies$CIK)
companies <- companies[!duplicated(companies[,'CIK']),]
risk_data <- read.csv("risk_data.csv")
business_data <- read.csv("business_data.csv")
## Clean and format risk.
risk_data <- unique(risk_data)
colnames(risk_data) <- c('CIK', 'Jaccard', 'TF-IDF', 'Word2Vec', 'Common Words', 'Deleted Words','New Words', 'Total Words', 'Top Words', 'Year')
risk_data[,c(2:7)] = round(risk_data[,c(2:7)],2)
risk_data$CIK <- sprintf('%010d', risk_data$CIK)
risk_data <- merge(x = risk_data, y = companies[,c('CIK', 'Company.Name')], by = "CIK", all.x = TRUE)
## Clean and format business.
business_data <- unique(business_data)
colnames(business_data) <- c('CIK', 'Jaccard', 'TF-IDF', 'Word2Vec', 'Common Words', 'Deleted Words','New Words', 'Total Words', 'Top Words', 'Year')
business_data[,c(2:7)] = round(business_data[,c(2:7)],2)
business_data$CIK <- sprintf('%010d', business_data$CIK)
business_data <- merge(x = business_data, y = companies[,c('CIK', 'Company.Name')], by = "CIK", all.x = TRUE)
## Remove 2007.
risk_data <- risk_data[risk_data$Year != 2007,]
business_data <- business_data[business_data$Year != 2007,]
## Normalize word2vec.
risk_data$Word2Vec <- round(risk_data$Word2Vec / max(risk_data$Word2Vec),2)
business_data$Word2Vec <- round(business_data$Word2Vec / max(business_data$Word2Vec),2)
## Get means.
means <- round(colMeans(risk_data[,c('Jaccard','TF-IDF','Word2Vec')]),2)
means <- round(colMeans(business_data[,c('Jaccard','TF-IDF','Word2Vec')]),2)
## Get IDs.
#mapping <- seq(length(unique(data$Company.Name)))
#names(mapping) <- unique(data$Company.Name)
#data$Id <- mapping[data$Company.Name]
## Filled heatmap dataset.
all_years = c(2008,2009,2010,2011,2012,2013,2014,2015)
all_companies <- unique(risk_data$CIK)
filled_risk <- risk_data[, c('Year', 'CIK', 'Company.Name', 'Jaccard', 'TF-IDF', 'Word2Vec')]
filled_business <- business_data[, c('Year', 'CIK', 'Company.Name', 'Jaccard', 'TF-IDF', 'Word2Vec')]
## Filled Risk.
for(company in all_companies) {
tmp_data <- risk_data[risk_data$CIK == company, c('Year', 'CIK', 'Company.Name', 'Jaccard', 'TF-IDF', 'Word2Vec')]
missing_years = setdiff(all_years, unique(tmp_data$Year))
name <- unique(tmp_data$Company.Name)
cik <- unique(tmp_data$CIK)
for(year in missing_years) {
new_row = c(year, cik, name, means[1], means[2], means[3])
filled_risk = rbind(filled_risk, new_row)
}
}
filled_risk <- arrange(filled_risk, CIK, Year)
update.cols <- c('Year','Jaccard', 'TF-IDF', 'Word2Vec')
filled_risk[update.cols] <- sapply(filled_risk[update.cols],as.numeric)
## Filled Business.
for(company in all_companies) {
tmp_data <- business_data[business_data$CIK == company, c('Year', 'CIK', 'Company.Name', 'Jaccard', 'TF-IDF', 'Word2Vec')]
missing_years = setdiff(all_years, unique(tmp_data$Year))
name <- unique(tmp_data$Company.Name)
cik <- unique(tmp_data$CIK)
for(year in missing_years) {
new_row = c(year, cik, name, means[1], means[2], means[3])
filled_business = rbind(filled_business, new_row)
}
}
filled_business <- arrange(filled_business, CIK, Year)
update.cols <- c('Year','Jaccard', 'TF-IDF', 'Word2Vec')
filled_business[update.cols] <- sapply(filled_business[update.cols],as.numeric)
## Get IDs.
mapping_risk <- seq(length(unique(filled_risk$Company.Name)))
names(mapping_risk) <- unique(filled_risk$Company.Name)
filled_risk$Id <- mapping_risk[filled_risk$Company.Name]
risk_data$Id <- mapping_risk[risk_data$Company.Name]
mapping_business <- seq(length(unique(filled_business$Company.Name)))
names(mapping_business) <- unique(filled_business$Company.Name)
filled_business$Id <- mapping_business[filled_business$Company.Name]
business_data$Id <- mapping_business[business_data$Company.Name]
unique(filled_business$Company.Name)
setwd('/Users/manuelrueda/Dropbox/Documents/python/f16-GS/capstone_app')
companies <- read.csv('cik_sample.csv', stringsAsFactors = FALSE)
colnames(companies) <- c('Company.Name', 'CIK')
companies$CIK <- sprintf('%010d', companies$CIK)
companies <- companies[!duplicated(companies[,'CIK']),]
risk_data <- read.csv("risk_data.csv")
business_data <- read.csv("business_data.csv")
risk_data <- unique(risk_data)
colnames(risk_data) <- c('CIK', 'Jaccard', 'TF-IDF', 'Word2Vec', 'Common Words', 'Deleted Words','New Words', 'Total Words', 'Top Words', 'Year')
risk_data[,c(2:7)] = round(risk_data[,c(2:7)],2)
risk_data$CIK <- sprintf('%010d', risk_data$CIK)
risk_data <- merge(x = risk_data, y = companies[,c('CIK', 'Company.Name')], by = "CIK", all.x = TRUE)
business_data <- unique(business_data)
colnames(business_data) <- c('CIK', 'Jaccard', 'TF-IDF', 'Word2Vec', 'Common Words', 'Deleted Words','New Words', 'Total Words', 'Top Words', 'Year')
business_data[,c(2:7)] = round(business_data[,c(2:7)],2)
business_data$CIK <- sprintf('%010d', business_data$CIK)
business_data <- merge(x = business_data, y = companies[,c('CIK', 'Company.Name')], by = "CIK", all.x = TRUE)
risk_data <- risk_data[risk_data$Year != 2007,]
business_data <- business_data[business_data$Year != 2007,]
risk_data$Word2Vec <- round(risk_data$Word2Vec / max(risk_data$Word2Vec),2)
business_data$Word2Vec <- round(business_data$Word2Vec / max(business_data$Word2Vec),2)
means <- round(colMeans(risk_data[,c('Jaccard','TF-IDF','Word2Vec')]),2)
means <- round(colMeans(business_data[,c('Jaccard','TF-IDF','Word2Vec')]),2)
all_years = c(2008,2009,2010,2011,2012,2013,2014,2015)
all_companies <- unique(risk_data$CIK)
filled_risk <- risk_data[, c('Year', 'CIK', 'Company.Name', 'Jaccard', 'TF-IDF', 'Word2Vec')]
filled_business <- business_data[, c('Year', 'CIK', 'Company.Name', 'Jaccard', 'TF-IDF', 'Word2Vec')]
for(company in all_companies) {
tmp_data <- risk_data[risk_data$CIK == company, c('Year', 'CIK', 'Company.Name', 'Jaccard', 'TF-IDF', 'Word2Vec')]
missing_years = setdiff(all_years, unique(tmp_data$Year))
name <- unique(tmp_data$Company.Name)
cik <- unique(tmp_data$CIK)
for(year in missing_years) {
new_row = c(year, cik, name, means[1], means[2], means[3])
filled_risk = rbind(filled_risk, new_row)
}
}
filled_risk <- arrange(filled_risk, CIK, Year)
update.cols <- c('Year','Jaccard', 'TF-IDF', 'Word2Vec')
filled_risk[update.cols] <- sapply(filled_risk[update.cols],as.numeric)
for(company in all_companies) {
tmp_data <- business_data[business_data$CIK == company, c('Year', 'CIK', 'Company.Name', 'Jaccard', 'TF-IDF', 'Word2Vec')]
missing_years = setdiff(all_years, unique(tmp_data$Year))
name <- unique(tmp_data$Company.Name)
cik <- unique(tmp_data$CIK)
for(year in missing_years) {
new_row = c(year, cik, name, means[1], means[2], means[3])
filled_business = rbind(filled_business, new_row)
}
}
filled_business <- arrange(filled_business, CIK, Year)
update.cols <- c('Year','Jaccard', 'TF-IDF', 'Word2Vec')
filled_business[update.cols] <- sapply(filled_business[update.cols],as.numeric)
mapping_risk <- seq(length(unique(filled_risk$Company.Name)))
names(mapping_risk) <- unique(filled_risk$Company.Name)
filled_risk$Id <- mapping_risk[filled_risk$Company.Name]
risk_data$Id <- mapping_risk[risk_data$Company.Name]
seq(length(unique(filled_business$Company.Name)))
unique(filled_business$Company.Name)
filled_business[is.na(filled_business$Company.Name),]
business_data[is.na(business_data$Company.Name),]
runApp()
